<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maria AI Agent</title>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
            margin: 0;
        }

        #chat-container {
            width: 600px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        #chat-frame {
            border: 1px solid #ccc;
            padding: 20px;
            border-radius: 10px;
        }

        #intro {
            text-align: center;
            margin-bottom: 10px;
        }

        #intro h2 {
            font-size: 20px;
            margin-bottom: 5px;
        }

        #intro p {
            font-size: 14px;
            color: #555;
        }

        #chat-messages {
            padding: 10px;
            max-height: 300px;
            overflow-y: auto;
        }

        .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 5px;
            max-width: 80%;
        }

        .user-message {
            background-color: #e0f0ff;
            align-self: flex-end;
        }

        .bot-message {
            background-color: #f0f0f0;
            align-self: flex-start;
        }

        #chat-input {
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: flex-end; /* Align items to the right */
        }

        #text-input {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
             width: 100%; /* Make text input take full width */
            margin-bottom: 5px;
        }

        #send-button {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
             margin-left: 10px;
        }

        .option-button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            margin-right: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .option-button:hover {
            background-color: #218838;
        }

        .options-container {
            display: flex;
            margin-bottom: 10px;
            flex-wrap: wrap; /* Allow buttons to wrap to the next line */
            gap: 5px; /* Space between buttons */
        }

        #suggestion-container {
            margin-top: 10px;
            font-size: 14px;
            text-align: left;
            width: 100%;
            display: none; /* Initially hide the suggestion container */
        }

        #suggestion-label{
          font-weight: bold; /* Make the label bold */
        }

        .suggestion-button{
            background: none;
            color: #007bff;
            border: none;
            padding: 0;
            font-size: 14px;
            cursor: pointer;
            text-decoration: underline;
            margin-left: 5px;
            display: inline;
        }
        .suggestion-button:hover {
             color: #0056b3;
             background: none;
         }
          #input-send-container {
            display: flex;
            width: 100%; /* Make sure container takes the full width */
        }
    </style>
</head>
<body>

    <div id="chat-container">
        <div id="chat-frame">
            <div id="intro">
                <h2>Hello! I am Maria, your AI Agent</h2>
                <p>I can help transform your customer experience, let's talk</p>
            </div>
            <div id="chat-messages">
                <!-- Messages will be displayed here -->
                <div class="message bot-message">Hello! How can I help you today?</div>
                <div class="options-container" id="initial-options">
                    <!-- Options will be added here -->
                </div>
            </div>
            <div id="chat-input">
                 <div id="input-send-container">
                    <input type="text" id="text-input" placeholder="Type your message...">
                    <button id="send-button">Send</button>
                </div>
                  <div id="suggestion-container">
                    <span id="suggestion-label"></span>
                    <!--suggestion buttons will be added here-->
                </div>
            </div>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chat-messages');
        const textInput = document.getElementById('text-input');
        const sendButton = document.getElementById('send-button');
        const initialOptions = document.getElementById('initial-options');
        const suggestionContainer = document.getElementById('suggestion-container');
        const suggestionLabel = document.getElementById('suggestion-label');

        //list of prompt suggestions
        const promptSuggestions = [
            "Can you tell me how you can transform my customer experience?"
            // Add more prompts here as needed
        ];

        // State to track bot creation progress and initial suggestion
        let botCreationState = {
            inProgress: false,
            botName: null,
            botPurpose: null,
            botTone: null
        };
        let initialSuggestionShown = false;
        let waitingForInitialResponse = false; // Changed to false
        let userMessageCount = 0; // Track user message count

         function createSuggestionButtons() {
            suggestionContainer.innerHTML = ''; // Clear existing buttons
            suggestionLabel.textContent = "Suggested prompt: ";

            promptSuggestions.forEach(prompt => {
                const button = document.createElement('button');
                button.classList.add('suggestion-button');
                button.textContent = prompt;
                button.addEventListener('click', handleSuggestionClick);
                suggestionContainer.appendChild(button);
            });
        }

        function addMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', `${type}-message`);
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addOptions(options, container = initialOptions) {
            // Clear existing options (if any)
            container.innerHTML = '';

            const optionsContainer = document.createElement('div');
            optionsContainer.classList.add('options-container');

            options.forEach(option => {
                const button = document.createElement('button');
                button.classList.add('option-button');
                button.textContent = option.label;
                button.setAttribute('data-option', option.value);
                button.addEventListener('click', handleOptionClick);
                optionsContainer.appendChild(button);
            });

            chatMessages.appendChild(optionsContainer);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function getHardcodedResponse(userInput) {
            userInput = userInput.toLowerCase();

            if (waitingForInitialResponse) {
                waitingForInitialResponse = false;
                addInitialOptions();
                return "I can help in the following ways:";
            } else if (userInput.includes("hello") || userInput.includes("hi")) {
                return "Hello there!";
            } else if (userInput.includes("how are you")) {
                return "I'm doing well, thank you for asking!";
            } else if (userInput.includes("what's your name")) {
                return "I'm Maria, and can transform your customer experience. Tell me how I can help!";
            } else if (userInput.includes("bye") || userInput.includes("goodbye")) {
                return "Goodbye!";
            } else {
                return "I'm not sure I understand. Can you rephrase?";
            }
        }

        function showBotCreationQuestion(question) {
            addMessage(question, 'bot');
        }

        function startBotCreation() {
            botCreationState.inProgress = true;
            showBotCreationQuestion("What would you like to name your bot?");
        }

        function handleBotCreationResponse(userResponse) {
            if (!botCreationState.botName) {
                botCreationState.botName = userResponse;
                showBotCreationQuestion("What is the primary purpose of your bot?");
            } else if (!botCreationState.botPurpose) {
                botCreationState.botPurpose = userResponse;
                showBotCreationQuestion("What tone should your bot have (e.g., friendly, formal, playful)?");
            } else if (!botCreationState.botTone) {
                botCreationState.botTone = userResponse;
                // data has been gathered.
                addMessage("Thank you! We are now creating your bot...", 'bot');
                // reset values and inProgress
                botCreationState = {
                    inProgress: false,
                    botName: null,
                    botPurpose: null,
                    botTone: null
                };
                // reset options
                addInitialOptions();

                // Send botCreationState to backend
                console.log("Bot Creation Data:", botCreationState);
                // In real-world it would be sent to backend
            }
        }

        function handleOptionClick(event) {
            const selectedOption = event.target.dataset.option;

            if (selectedOption === 'create-bot') {
                startBotCreation();
                initialOptions.innerHTML = ''; // Clean initial options
            } else if (selectedOption === 'general-inquiry') {
                addMessage("How can i help you today?", 'bot');
                initialOptions.innerHTML = ''; // Clean initial options
            }
            // can expand here on additional options
        }

        function sendMessage() {
            const userMessage = textInput.value;
            if (userMessage.trim() === '') return;

            addMessage(userMessage, 'user');
            textInput.value = '';

             // Check if bot creation is in progress
            if (botCreationState.inProgress) {
                handleBotCreationResponse(userMessage);
                return;
            }
           
             userMessageCount++; // Increment user message count
             // Show suggestion after two messages
             if (userMessageCount >= 2) {
                showSuggestions();
             }
             
            // Simulate bot response (replace with actual logic later)
             setTimeout(() => {
              const botResponse = getHardcodedResponse(userMessage);
              addMessage(botResponse, 'bot');
            }, 500);
        }

        function addInitialOptions() {
            addOptions([
                { label: "Create a Bot", value: "create-bot" },
                { label: "General Inquiry", value: "general-inquiry" }
            ]);
        }

        function handleSuggestionClick(event) {
            waitingForInitialResponse = true;
            textInput.value = event.target.textContent; // Set text to the button text
            sendMessage();
        }
         function showSuggestions() {
            createSuggestionButtons();
            suggestionContainer.style.display = 'block';
        }
       
        sendButton.addEventListener('click', sendMessage);
        textInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                sendMessage();
            }
        });
        // Create suggestion buttons on start
        createSuggestionButtons()
    </script>

</body>
</html>
